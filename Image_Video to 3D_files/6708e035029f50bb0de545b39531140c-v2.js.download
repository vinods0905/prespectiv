"use strict";(self.webpackChunksketchfab=self.webpackChunksketchfab||[]).push([[2322],{tjn4:(t,e,r)=>{r.d(e,{Z:()=>w});var i=r("hrlB"),n=r("k46e"),s=r("qqsP"),o=r("Cgfs"),a=r("jQDz"),u=r("R4My"),h=r.n(u),c=r("vCKz"),p=r("AsK1"),g=r("lrhy"),f=r("fAYH"),l=r("t3PY");const d=(t,e)=>Math.min(t,Math.max(0,parseInt(e)||0)),P=()=>{const t={};return{get:e=>t[e],update:(e,r=[])=>{r.forEach((r=>{t[r.uid]=e}))}}},v=(t,e)=>{const r=()=>{const e=(0,f.Z)(t.lastPage)?t.lastPage:0,r=d(e,t.firstPage);return{lastPage:e,currentPageIndex:r,hasPrevious:0!==r}};let i=P(),n=r();const s=t=>e=>(i.update(t,e.results),n.currentPageIndex=t,e.previous||(n.hasPrevious=!1),e.next?n.lastPage=1/0:n.lastPage=t,e);return{type:"offset",loadPrevious:t=>{const r=d(n.lastPage,n.currentPageIndex-1);return e(r,t).then(s(r))},loadNext:t=>{const r=d(n.lastPage,n.currentPageIndex+1);return e(r,t).then(s(r))},loadFirst:t=>{n=r(),i=P();return e(0,t).then(s(0))},reset:()=>{n=r()},hasPrevious:()=>n.hasPrevious,hasNext:()=>n.currentPageIndex+1<n.lastPage,isFirst:()=>0===n.currentPageIndex,getQueryParamsForElementUid:t=>({page:i.get(t)||""}),getQueryParams:()=>({page:n.currentPageIndex}),setInitialQuery:(t="",e={})=>{const r=((t="")=>(0,l.Qc)(t.split("?")[1]||"").page)(t);i.update(r,e.results)}}};var y=r("NQ1V");function m(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function x(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?m(Object(r),!0).forEach((function(e){(0,y.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}const b=(t="")=>(0,l.Qc)(t.split("?")[1]||"").cursor,O=()=>{const t={};return{get:e=>t[e],update:(e,r=[])=>{r.forEach((r=>{t[r.uid]=e}))}}},C=(t,e)=>{const r=()=>({previousCursor:t.previous||null,currentCursor:t.current,nextCursor:t.next||null});let i=O(),n=r();const s=(t,e)=>r=>(i.update(t,r.results),n.currentCursor=t,e.setNext&&(n.nextCursor=r.next?b(r.next):null),e.setPrevious&&(n.previousCursor=r.previous?b(r.previous):null),r);return{type:"cursor",loadPrevious:t=>e(n.previousCursor,t).then(s(n.previousCursor,x(x({},t),{},{setPrevious:!0}))),loadNext:t=>e(n.nextCursor,t).then(s(n.nextCursor,x(x({},t),{},{setNext:!0}))),loadFirst:t=>(n=r(),i=O(),e(n.currentCursor,t).then(s(n.current,x(x({},t),{},{setNext:!0,setPrevious:!0})))),reset:()=>{n=r()},hasPrevious:()=>null!==n.previousCursor,hasNext:()=>null!==n.nextCursor,isFirst:()=>n.currentCursor===t.current,getQueryParamsForElementUid:t=>({cursor:i.get(t)}),getQueryParams:()=>({cursor:n.currentCursor}),setInitialQuery:(t="",e={})=>{const r=b(t);i.update(r,e.results)}}};var Z=r("JBVY"),z=r("zIYZ"),L=r("g/7r");function k(t,e,r){var i=[],n=(0,o.Z)((function(){var t=i.slice();i=[],r.trigger(e,t)}),20),s=function(t){i.push(t),n()};return r.on(t,s),function(){r.off(t,s)}}var M=r("OM1T"),N=r("Oyie"),j=(0,c.Z)(["initialize"])(h().Collection);const w=j.extend({mixins:[M.Z],optionsTypes:{offset:M.M.number,pageSize:M.M.number,paginationType:M.M.oneOf(["cursor","offset"]),lastPage:M.M.number,firstPage:M.M.number,minOffset:M.M.number,maxOffset:M.M.number,cursor:M.M.shape({previous:M.M.string,next:M.M.string})},defaultOptions:function(){return{pageSize:i.Z.apiPageSize,paginationType:"cursor",offset:0,minOffset:0,maxOffset:1/0,cursor:{previous:null}}},backend:p.Z,previousPromise:N.resolve(),constructor:function(){this.options=(0,n.Z)({},this.defaultOptions(),(0,s.Z)(arguments[1]||{},(function(t){return void 0!==t}))),j.apply(this,arguments)},initialize:function(){this.options.backend&&(this.backend=this.options.backend),this._loading="none",k("add","afterAdd",this),k("remove","afterRemove",this),this.triggerAfterRequest=(0,o.Z)(this.triggerAfterRequest.bind(this),20),this.initializePagination(),j.prototype.initialize.apply(this,arguments)},at:function(t){return t<0?void 0:j.prototype.at.call(this,t)},domain:function(){return(0,a.Z)(this.backend,"domain")},parse:function(t){return this.backend.parse(t)},queryParams:function(){return this.isCursorPagination()?{cursor:this._currentCursor,count:(0,a.Z)(this.options,"pageSize")}:{offset:this.options.offset,count:(0,a.Z)(this.options,"pageSize")}},url:function(){var t=(0,a.Z)(this,"domain")+(0,a.Z)(this,"endpoint")+Z.ZP.craft("?",this.queryParams());return t=t.replace(/(?!^)\/{2,}/g,"/")},fetch:function(){this.triggerBeforeRequest();var t=this.previousPromise;return this.previousPromise=N.resolve(j.prototype.fetch.apply(this,arguments)).then((function(e){return(0,g.Vs)(1e3,t).catch(L.EI).then((function(){return e}))})),this.previousPromise.then(function(t){return this.previousPromise=N.resolve(),this.triggerAfterRequest(t),t}.bind(this))},reset:function(){j.prototype.reset.apply(this,arguments),this.pagination.reset()},triggerBeforeRequest:function(){this.trigger("beforeRequest")},triggerAfterRequest:function(t){this.trigger("afterRequest",t)},isCursorPagination:function(){return"cursor"===this.pagination.type},initializePagination:function(){"offset"===this.options.paginationType?this._initializeOffsetPagination():this._initializeCursorPagination()},_initializeCursorPagination:function(){var t=this.options.cursor;this.pagination=C(t,function(t,e){return this._currentCursor=t,N.resolve(this.fetch((0,n.Z)({},e,{reset:!1,add:!1,remove:!1})))}.bind(this))},_initializeOffsetPagination:function(){var t={lastPage:this.options.lastPage,firstPage:this.options.firstPage};this.pagination=v(t,function(t,e){return this.options.offset=this.options.minOffset+(0,a.Z)(this.options,"pageSize")*t,N.resolve(this.fetch((0,n.Z)({},e,{reset:!1,add:!1,remove:!1})))}.bind(this))},loadPreviousPage:function(t){this.setLoading("previous");var e=t||{};return this.pagination.loadPrevious(e).then((t=>{var r=this.parse(t);return e.setPrevious&&e.setNext?this.set(r):this.add(r,{at:0}),this.setLoading("none"),r})).catch((t=>{throw this.setLoading("none"),t}))},loadNextPage:function(t){this.setLoading("next");var e=t||{};return this.pagination.loadNext(e).then((t=>{var r=this.parse(t);return e.setPrevious&&e.setNext?this.set(r):this.add(r),this.setLoading("none"),r})).catch((t=>{throw this.setLoading("none"),t}))},loadFirstPage:function(t){return this.setLoading("refresh"),this.pagination.loadFirst(t||{}).then((t=>{const e=this.parse(t);return e.length||this.trigger("empty"),this.set(e),this.setLoading("none"),e})).catch((t=>{throw this.setLoading("none"),t}))},loadLatestItems:function(){return this.setLoading("refresh"),this.pagination.loadFirst({allowPrefetching:!1}).then((t=>{var e=this.parse(t);return this.add(e,{at:0}),this.setLoading("none"),e})).catch((t=>{throw this.setLoading("none"),t}))},hasPreviousPage:function(){return this.pagination.hasPrevious()},hasNextPage:function(){return this.pagination.hasNext()},setLoading:function(t){this._loading=t,this.trigger("loadingChanged",t)},loading:function(){return this._loading},isLoading:function(){return"none"!==this._loading}},{extend:function(t,e){var r=(0,n.Z)({},t,{defaultOptions:(0,z.Cn)((0,L.J$)(this.prototype.defaultOptions||{}),(0,L.J$)(t.defaultOptions||{})),optionTypes:(0,n.Z)({},this.prototype.optionTypes||{},t.optionTypes||{})});return j.extend.call(this,r,e)}})}}]);
//# sourceMappingURL=6708e035029f50bb0de545b39531140c-v2.js.map